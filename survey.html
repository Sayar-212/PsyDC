<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PsyDC - Survey Validation</title>
    <link rel="icon" type="image/png" href="logo-icon.png">
    <link rel="stylesheet" href="survey.css">
</head>
<body>
    <div class="header">
        <div class="progress-info">
            <span id="patientNum">Patient 1/350</span>
            <span id="clinicianName"></span>
        </div>
        <div class="header-buttons">
            <button id="toggleQuestions" class="toggle-btn">Show PHQ-9 Questions</button>
            <button id="exportBtn" class="export-btn">Export Results</button>
        </div>
    </div>

    <div id="questionsPanel" class="questions-panel" style="display: none;">
        <h3>PHQ-9 Questions</h3>
        <p><strong>Over the last 2 weeks, how often have you been bothered by:</strong></p>
        <ol>
            <li>Little interest or pleasure in doing things</li>
            <li>Feeling down, depressed, or hopeless</li>
            <li>Trouble falling or staying asleep, or sleeping too much</li>
            <li>Feeling tired or having little energy</li>
            <li>Poor appetite or overeating</li>
            <li>Feeling bad about yourself or that you are a failure</li>
            <li>Trouble concentrating on things</li>
            <li>Moving or speaking slowly, or being fidgety/restless</li>
            <li>Thoughts that you would be better off dead or hurting yourself</li>
        </ol>
        <p><strong>Response Scale:</strong> (0) Not at all • (1) Several days • (2) More than half the days • (3) Nearly every day</p>
    </div>

    <!-- Loading Mask -->
    <div id="loadingMask" class="loading-mask">
        <div class="loading-content">
            <div class="spinner"></div>
            <h3>Checking existing data...</h3>
            <p>Please wait while we verify your progress</p>
        </div>
    </div>

    <main class="survey-container" style="display: none;">
        <div class="patient-card">
            <h2>PHQ-9 Assessment Review</h2>
            
            <div class="score-section">
                <div class="score-box">
                    <label>AI Score</label>
                    <div class="score-value" id="aiScore"></div>
                </div>
                <div class="severity-box">
                    <label>AI Severity</label>
                    <div class="severity-value" id="aiSeverity"></div>
                </div>
            </div>

            <div class="answers-section">
                <div id="answersList"></div>
            </div>

            <div class="nav-buttons">
                <button id="prevBtn" class="btn-nav">← Previous</button>
                <button id="nextBtn" class="btn-nav">Next →</button>
            </div>

            <div class="action-buttons">
                <button id="validBtn" class="btn-valid">Valid</button>
                <button id="invalidBtn" class="btn-invalid">Not Valid</button>
            </div>

            <div id="correctionForm" class="correction-form" style="display:none;">
                <h3>Provide Correction</h3>
                <input type="number" id="newScore" placeholder="Corrected Score (0-27)" min="0" max="27" required>
                <input type="text" id="newSeverity" placeholder="Corrected Severity" required>
                <textarea id="reason" placeholder="Reason for correction" rows="3" required></textarea>
                <button id="submitCorrection" class="btn-submit">Submit & Next</button>
            </div>
        </div>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="survey.js"></script>
</body>
</html>
